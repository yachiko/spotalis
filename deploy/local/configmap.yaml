apiVersion: v1
kind: ConfigMap
metadata:
  name: spotalis-config
  namespace: spotalis-system
  labels:
    app.kubernetes.io/name: spotalis
    app.kubernetes.io/instance: spotalis
    app.kubernetes.io/component: controller
    app.kubernetes.io/managed-by: kubectl
data:
  config.yaml: |
    operator:
      namespace: "spotalis-system"
      leaderElection:
        enabled: true
        id: "spotalis-controller-leader"
        namespace: "spotalis-system"
      readOnlyMode: false

    controllers:
      reconcileInterval: "30s"  # Faster reconciliation for development
      maxConcurrentReconciles: 1
      rateLimit:
        qps: 100.0
        burst: 150
      workloadTiming:
        cooldownPeriod: "10s"
        disruptionRetryInterval: "1m"
        disruptionWindowPollInterval: "10m"

    webhook:
      enabled: true
      port: 9443
      certDir: "/tmp/k8s-webhook-server/serving-certs"
      certName: "tls.crt"
      keyName: "tls.key"

    observability:
      logging:
        level: "info"
        format: "json" 
        output: "stdout" 
        addCaller: true 
        development: true
      metrics:
        enabled: true
        bindAddress: ":8080"
        path: "/metrics"
      health:
        enabled: true
        bindAddress: ":8081"
        path: "/healthz"